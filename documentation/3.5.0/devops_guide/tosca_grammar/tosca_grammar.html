
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-73216650-1', 'auto');
ga('set', {
  page: '/documentation/3.5.0/devops_guide/tosca_grammar/tosca_grammar.html',
  title: 'TOSCA grammar'
});
ga('send', 'pageview');

</script>

<div class="container-fluid">
  <div class="row">
    
      <div class="col-sm-4 col-md-3">
        <div id="sidebar_menu" class="tree" role="complementary"></div>
      </div>
      <div id="content" class="col-sm-8 col-md-9">
    
        <div style="height: 50px;">
          <h1 class="pull-left" style="margin-top: 0px;">TOSCA grammar</h1>
          <a class="btn btn-primary pull-right" href="http://prose.io/#alien4cloud/alien4cloud.github.io/edit/sources/documentation/3.5.0/devops_guide/tosca_grammar/tosca_grammar.md"><i class="fa fa-pencil-square-o"></i> Edit (pull request)</a>
        </div>
        <p>This section describes the TOSCA grammar as supported in latest alien4cloud version.</p>

<p>Alien4cloud supports multiple versions of the <strong>tosca_definitions_version</strong>:</p>

<ul>
  <li>alien_dsl_3.0.0: DSL used in alien4cloud 2.0.0</li>
  <li>alien_dsl_1_4_0: DSL used in alien4cloud 1.4.0</li>
  <li>alien_dsl_1_3_0: DSL used in alien4cloud 1.3.0</li>
  <li>alien_dsl_1_2_0: DSL used in alien4cloud 1.2.0 <em>deprecated</em></li>
  <li>
    <p>alien_dsl_1_1_0: DSL used in alien4cloud 1.1.0 <em>deprecated</em>. While alien4cloud is still able to parse this definition version it is not officially supported and not recommended.</p>
  </li>
  <li>tosca_simple_yaml_1_0: Official Tosca definition. The support is getting improved but some elements of the specification may not be supported yet and therefore we donâ€™t recommend using it with alien4cloud.</li>
  <li>http://docs.oasis-open.org/tosca/ns/simple/yaml/1.0: Same as <em>tosca_simple_yaml_1_0</em></li>
</ul>

<p>The recommended version is <strong>alien_dsl_2_0_0</strong> and provides all the functionalities that alien4cloud currently supports.</p>

<p>Child pages details the specification as currently supported in alien4cloud.</p>

<h1 id="migration-from-120-version">Migration from 1.2.0 version</h1>

<p>This section highlight the chances between alien_dsl_1_2_0 and alien_dsl_1_3_0 and is intendeed for users to easily migrate to the latest version.</p>

<h2 id="type-validations">Type Validations</h2>

<p>Previous version of alien4cloud parser were not checking the types used in requirement_definition and capability definition. This has been fixed in 1.4.0, this should not change your types but will impact the order in which you can upload your archives in alien4cloud.</p>

<h2 id="requirement-definition">Requirement definition</h2>

<p>Many things have changed in requirement definition dsl. The following grammar definitions highlight the differences between alien_dsl_1_2_0 and alien_dsl_1_3_0:</p>

<p><strong>alien_dsl_1_2_0</strong>:</p>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">&lt;requirement_name&gt;</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;type_of_capability or type_of_node&gt;</span> <span class="c1"># required</span>
  <span class="l-Scalar-Plain">node_filter</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;node_filter&gt;</span>
  <span class="l-Scalar-Plain">description</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;description&gt;</span>
  <span class="l-Scalar-Plain">occurrences</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">min</span><span class="p-Indicator">,</span> <span class="nv">max</span><span class="p-Indicator">]</span>
  <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;type_of_relationship&gt;</span>
  <span class="l-Scalar-Plain">relationship</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;type_of_relationship&gt;</span> <span class="c1"># both type and relationship keynames could be used but only one at a time.</span>
  <span class="l-Scalar-Plain">capability</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;name_of_target_capability&gt;</span> <span class="c1"># name in the target node / should have node defined.</span></code></pre></div>

<p><strong>alien_dsl_1_3_0</strong>:</p>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">&lt;requirement_name&gt;</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">capability</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;type_of_capability&gt;</span> <span class="c1"># required</span>
    <span class="l-Scalar-Plain">node</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;type_of_node&gt;</span>
    <span class="l-Scalar-Plain">node_filter</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;node_filter&gt;</span>
    <span class="l-Scalar-Plain">description</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;description&gt;</span>
    <span class="l-Scalar-Plain">occurrences</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">min</span><span class="p-Indicator">,</span> <span class="nv">max</span><span class="p-Indicator">]</span>
    <span class="l-Scalar-Plain">relationship</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;type_of_relationship&gt;</span>
    <span class="l-Scalar-Plain">capability_name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;name_of_target_capability&gt;</span> <span class="c1"># name in the target node / should have node defined.</span></code></pre></div>

<p>Example below details</p>

<p><strong>alien_dsl_1_2_0</strong>:</p>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">node_types</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">alien4cloud.examples.MyNode</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">derived_from</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tosca.nodes.SoftwareComponent</span>
    <span class="l-Scalar-Plain">requirements</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">host</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tosca.nodes.Compute</span>
        <span class="l-Scalar-Plain">relationship_type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tosca.relationships.HostedOn</span>
        <span class="l-Scalar-Plain">capability</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">host</span>
        <span class="l-Scalar-Plain">occurrences</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">1</span><span class="p-Indicator">,</span> <span class="nv">1</span><span class="p-Indicator">]</span></code></pre></div>

<p><strong>alien_dsl_1_3_0</strong>:</p>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">node_types</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">alien4cloud.examples.MyNode</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">derived_from</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tosca.nodes.SoftwareComponent</span>
    <span class="l-Scalar-Plain">requirements</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">host</span><span class="p-Indicator">:</span>
          <span class="l-Scalar-Plain">capability</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tosca.capabilities.Root</span>
          <span class="l-Scalar-Plain">node</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tosca.nodes.Compute</span>
          <span class="l-Scalar-Plain">relationship</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tosca.relationships.HostedOn</span>
          <span class="l-Scalar-Plain">capability_name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">host</span>
          <span class="l-Scalar-Plain">occurrences</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">1</span><span class="p-Indicator">,</span> <span class="nv">1</span><span class="p-Indicator">]</span></code></pre></div>

<h2 id="deployment-artifacts">Deployment artifacts</h2>

<p>Artifact definition has changed and yaml node does not contains anymore both the name of artifact and the keynames as it has been defined in previous template versions. The previous notation was indeed more confusing and less inline with yaml definition.</p>

<div class="note info">
<p>1.4.0 also support repositories for artifacts. This section is just focused on templates migration and does not introduce new functionalities.</p>
</div>

<p><strong>alien_dsl_1_2_0</strong>:</p>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">node_types</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">alien4cloud.examples.MyNode</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">derived_from</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tosca.nodes.SoftwareComponent</span>
    <span class="l-Scalar-Plain">artifacts</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">simple_config</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">config/config.yml</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">config</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">config/config.yml</span>
        <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tosca.artifacts.File</span>

<span class="l-Scalar-Plain">relationship_types</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">alien4cloud.examples.MyRelationship</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">artifacts</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">simple_config</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">config/config.yml</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">config</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">config/config.yml</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tosca.artifacts.File</span>

<span class="l-Scalar-Plain">topology_template</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">input_artifacts</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">config</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tosca.artifacts.File</span>

  <span class="l-Scalar-Plain">node_templates</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">my_node</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">alien4cloud.examples.MyNode</span>
      <span class="l-Scalar-Plain">artifacts</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">config</span><span class="p-Indicator">:</span>
          <span class="l-Scalar-Plain">implementation</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">config/config.yml</span>
          <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tosca.artifacts.File</span></code></pre></div>

<p><strong>alien_dsl_1_3_0</strong>:</p>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">node_types</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">alien4cloud.examples.MyNode</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">derived_from</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tosca.nodes.SoftwareComponent</span>
    <span class="l-Scalar-Plain">artifacts</span><span class="p-Indicator">:</span>
      <span class="c1"># Simple definition remains the same</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">simple_config</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">config/config.yml</span>
      <span class="c1"># Complex definition is now more in line with yaml and introduce the file keyname and sub-level</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">config</span><span class="p-Indicator">:</span>
          <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">config/config.yml</span>
          <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tosca.artifacts.File</span>

<span class="l-Scalar-Plain">relationship_types</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">alien4cloud.examples.MyRelationship</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">artifacts</span><span class="p-Indicator">:</span>
    <span class="c1"># Simple definition remains the same</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">simple_config</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">config/config.yml</span>
    <span class="c1"># Complex definition is now more in line with yaml and introduce the file keyname and sub-level</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">config</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">config/config.yml</span>
        <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tosca.artifacts.File</span>

<span class="l-Scalar-Plain">topology_template</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">input_artifacts</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">config</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tosca.artifacts.File</span>

  <span class="l-Scalar-Plain">node_templates</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">my_node</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">alien4cloud.examples.MyNode</span>
      <span class="l-Scalar-Plain">artifacts</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">config</span><span class="p-Indicator">:</span>
          <span class="c1"># implementation keyname is now replaced with file to be in line with the deployment artifact rather than operation notation.</span>
          <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">config/config.yml</span>
          <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tosca.artifacts.File</span></code></pre></div>

<div class="note">
<p>alien_dsl_1_3_0 also supports simple definition of artifacts on templates and topology inputs while this was not authorized in previous versions:</p>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">topology_template</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">input_artifacts</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">config</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">config/config.yml</span>

  <span class="l-Scalar-Plain">node_templates</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">my_node</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">alien4cloud.examples.MyNode</span>
      <span class="l-Scalar-Plain">artifacts</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">config</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">config/config.yml</span></code></pre></div>

</div>

        <a class="btn btn-primary pull-right" href="http://prose.io/#alien4cloud/alien4cloud.github.io/edit/sources/documentation/3.5.0/devops_guide/tosca_grammar/tosca_grammar.md"><i class="fa fa-pencil-square-o"></i> Edit (pull request)</a>
	  </div>
    </div>
  </div>
</div><!-- /container -->

<script>
var hash = location.hash.replace( /^#/, '' );
if(hash && hash!== null && hash.match(/html$/)) {
} else {
  var newLocation = location.protocol+"//"+location.host+"#"+location.pathname;
  location.replace(newLocation);
}
</script>
<script type="text/javascript" src="/js/post-layout.js"></script>
<script>
$(document).ready(function () {
  makeSideBar('DOCUMENTATION-3.5.0', 'documentation/3.5.0/devops_guide/tosca_grammar/tosca_grammar.md');
});
</script>

<script>
$("div[data-gist]").gist();
</script>
